# CCO Web UI Dashboard Guide

Complete guide to accessing, using, and understanding the CCO analytics dashboard.

## Quick Start

### One-Command Start

```bash
# Start CCO with auto-open dashboard
./cco-proxy

# That's it! Dashboard automatically opens in your browser
# Access URL: http://localhost:3000
```

### What You'll See

When the dashboard opens:
- Dashboard header with connection status indicator
- Two tabs: Current Project, Machine-Wide Analytics
- Real-time metrics and charts
- Auto-refreshing data (every 5 seconds)

## Accessing the Dashboard

### Automatic (Default)

CCO automatically opens the dashboard when starting:

```bash
./cco-proxy
# Browser automatically opens to http://localhost:3000
```

**Supported platforms:**
- macOS: Uses `open` command
- Linux: Uses `xdg-open` command
- Windows: Uses `start` command
- Web: Direct URL access always works

### Manual Access

If the dashboard doesn't auto-open, access it manually:

```bash
# Get the URL from the startup output
# Or navigate directly to:
http://localhost:3000

# Custom port example
./cco-proxy --port 8888
# Then navigate to: http://localhost:8888
```

### Custom Port Configuration

```bash
# Start on a specific port
./cco-proxy --port 9000

# Use environment variable
export CCO_PORT=9000
./cco-proxy

# Override in config
./cco-proxy --host 127.0.0.1 --port 3000
```

## Dashboard Features

### Tab 1: Current Project Analytics

**Purpose**: Real-time metrics for the current project/context

**Displays**:
- **Cost**: Total cost for this project
  - Amount in dollars
  - 24-hour trend (up/down/neutral)
  - Trend percentage

- **Tokens**: Total tokens used
  - Token count
  - 24-hour trend
  - Trend percentage

- **Calls**: Number of API calls
  - Call count
  - 24-hour trend
  - Trend percentage

- **Response Time**: Average response time
  - Time in milliseconds
  - 24-hour trend
  - Trend percentage

**Activity Log**:
- Recent API calls with timestamps
- Model used for each call
- Response time for each call
- Cache hit/miss indicator
- Scrollable table of last 20-50 events

**Updates**: Refreshes every 5 seconds automatically

### Tab 2: Machine-Wide Analytics

**Purpose**: Overview of all projects and models on this machine

**Summary Cards**:
- Total cost (all projects combined)
- Number of active projects
- Total API calls made
- Total tokens consumed

**Projects Table**:
- Project names/identifiers
- Call count per project
- Token usage per project
- Total cost per project
- Last activity timestamp
- Sortable columns

**Models Table**:
- Model names (e.g., claude-opus-4, gpt-4)
- Calls per model
- Input tokens per model
- Output tokens per model
- Total cost per model
- Usage percentage

**Charts** (D3.js visualizations):
- **Cost Over Time**: Line chart showing cost trends
- **Cost by Project**: Bar chart comparing projects
- **Model Distribution**: Pie or donut chart showing model usage

**Data Quality**:
- Discrepancies list (if any data inconsistencies)
- Last sync timestamp
- Data accuracy indicator

**Updates**: Refreshes every 5 seconds automatically

## Auto-Refresh Behavior

### How It Works

The dashboard automatically refreshes every 5 seconds:

1. Client makes request to server
2. Server returns latest metrics
3. Dashboard updates display
4. Process repeats every 5 seconds

### What Updates

- **Cost metrics**: Real-time calculations
- **Token counts**: Latest aggregates
- **Call counts**: New API calls included
- **Charts**: Updated with new data
- **Activity log**: New events added
- **Cache statistics**: Hit/miss updates
- **Project list**: New projects appear
- **Connection status**: Shows if server is responding

### What Doesn't Update

- Saved filters or views
- User preferences or theme
- Manual input fields
- Sorted columns (sorts reset on refresh)

## Understanding the Metrics

### Cost

**Calculation**:
- Cost = (Input Tokens × Input Price) + (Output Tokens × Output Price)
- Prices vary by model (see model-pricing.json)
- Cache hits cost less than regular requests

**24-Hour Trend**:
- Shows cost change in last 24 hours
- Percentage indicates magnitude
- Green arrow = lower cost (good)
- Red arrow = higher cost
- Gray dash = stable

### Tokens

**Input Tokens**: Tokens sent to the model

**Output Tokens**: Tokens generated by the model

**Cache Tokens**: Counted separately for cache hits
- Much cheaper than regular tokens
- Shows "cache_read" in pricing

### Cache Hit Rate

**Calculation**:
- Hit Rate % = (Cache Hits) / (Total Requests) × 100
- Shows percentage of requests served from cache
- Higher is better (saves money)

**Savings Calculation**:
- Savings = (Cache Hits × Model Cost) - (Cache Hits × Cache Cost)
- Shows actual dollar amount saved
- Reflects current month's savings

### Response Time

**Metrics**:
- Average response time in milliseconds
- Cache hits: 1-5ms (very fast)
- Regular requests: 100-2000ms (depends on model)
- Slow requests: >2000ms (investigate)

## Browser Compatibility

### Tested Browsers

- Chrome/Chromium: Fully supported
- Firefox: Fully supported
- Safari: Fully supported
- Edge: Fully supported

### Minimum Requirements

- JavaScript enabled
- Modern CSS Grid support
- LocalStorage for preferences
- Fetch API support

## Troubleshooting

### Dashboard Not Opening Automatically

**Problem**: Browser doesn't open when starting CCO

**Solutions**:
1. Check if firewall is blocking browser launch
2. Manually navigate to http://localhost:3000
3. Verify CCO is running (check logs)
4. Try different port: `./cco-proxy --port 8000`

### Dashboard Shows "Disconnected"

**Problem**: Dashboard displays disconnection message

**Likely Causes**:
- CCO server stopped or crashed
- Port mismatch (different port than dashboard expects)
- Firewall blocking localhost connection
- Browser security settings blocking WebSocket

**Solutions**:
1. Restart CCO: `./cco-proxy`
2. Check server logs for errors
3. Verify port is correct in browser URL
4. Check browser console for JavaScript errors

### Charts Not Rendering

**Problem**: Charts appear blank or show errors

**Solutions**:
1. Check browser console for JavaScript errors
2. Verify D3.js CDN is accessible: https://d3js.org
3. Try refreshing page (F5 or Cmd+R)
4. Check if data is available (at least one metric)
5. Clear browser cache

### Metrics Not Updating

**Problem**: Dashboard shows old data

**Solutions**:
1. Make an API request to generate new metrics
2. Check if CCO server is running: `curl http://localhost:3000/health`
3. Verify cache is processing requests
4. Check browser console for network errors
5. Try manual refresh (F5)

### Performance Issues

**Problem**: Dashboard is slow or laggy

**Solutions**:
1. Close other browser tabs
2. Disable browser extensions
3. Reduce browser zoom level
4. Clear browser cache
5. Try different browser
6. Reduce auto-refresh frequency (modify dashboard.js)

## Customization

### Change Refresh Interval

Edit dashboard.js:
```javascript
CONFIG.UPDATE_INTERVAL = 5000;  // Change from 5000ms (5s) to your preference
```

Valid values:
- 1000 = 1 second (high CPU usage)
- 5000 = 5 seconds (default, balanced)
- 10000 = 10 seconds (lower CPU usage)

### Change Color Scheme

Edit dashboard.css `:root` section:
```css
:root {
    --accent-primary: #3b82f6;      /* Primary accent color */
    --accent-secondary: #06b6d4;    /* Secondary accent */
    --bg-primary: #0f172a;          /* Main background */
    --bg-secondary: #1e293b;        /* Secondary background */
    --text-primary: #e2e8f0;        /* Main text */
    --text-secondary: #94a3b8;      /* Secondary text */
    --border-color: #334155;        /* Border color */
    --success-color: #10b981;       /* Success indicator */
    --warning-color: #f59e0b;       /* Warning indicator */
    --error-color: #ef4444;         /* Error indicator */
}
```

### Customize Tab Display

Modify dashboard.html to customize which tabs appear:
```html
<!-- Default: Both tabs visible -->
<button class="tab-btn active" data-tab="project">Current Project</button>
<button class="tab-btn" data-tab="machine">Machine-Wide</button>
```

## API Endpoints

The dashboard uses these REST API endpoints:

### Health Check
```
GET /health
```

### Project Metrics
```
GET /api/project/stats
```

### Machine Analytics
```
GET /api/machine/stats
```

### Cache Statistics
```
GET /api/cache/stats
```

### Streaming Analytics
```
GET /api/stream (Server-Sent Events)
```

See USAGE.md for detailed endpoint documentation.

## Security Considerations

### Local Access Only

By default, CCO binds to `127.0.0.1`:
- Dashboard accessible only from localhost
- Not accessible from other machines
- Requires network admin to expose to internet

### Team/Shared Server Setup

To share dashboard with team:

```bash
# Bind to all interfaces
./cco-proxy --host 0.0.0.0 --port 3000

# Team members access via:
# http://team-server:3000
```

**Warning**: This exposes metrics to your network. Consider:
- Using firewall rules to restrict access
- Adding authentication (planned feature)
- Running on private network only
- VPN access to server

### Data Privacy

Dashboard shows:
- Project names and IDs
- Cost and usage metrics
- API models used
- Response times
- Cache statistics

**Does NOT show**:
- Actual prompts or responses
- API keys or credentials
- User authentication data
- Sensitive business logic

## Performance Tips

### For Large Datasets

- Limit data retention period
- Archive old analytics to file
- Clear cache periodically
- Use pagination in tables

### For High-Traffic Servers

- Increase refresh interval to 10+ seconds
- Reduce chart animation time
- Paginate table results
- Monitor CCO CPU usage

### Browser Optimization

- Close unnecessary tabs
- Disable browser extensions
- Allocate more RAM to browser
- Use modern, updated browser
- Clear browser cache regularly

## Advanced Features

### Export Data

Export analytics for external analysis via API:

```bash
# Export as JSON
curl http://localhost:3000/api/export/analytics?days=7 > analytics.json

# Export as CSV
curl http://localhost:3000/api/export/csv?days=30 > analytics.csv

# Export specific project
curl http://localhost:3000/api/export/project/my-project?format=json > project.json
```

## Support and Help

- Check USAGE.md for detailed command reference
- See TROUBLESHOOTING.md for common issues
- Review logs for error messages
- Check browser console for JavaScript errors
- Verify CCO is running: `curl http://localhost:3000/health`

## See Also

- README.md - Project overview
- USAGE.md - Complete command reference
- QUICK_START.md - Getting started guide
- TROUBLESHOOTING.md - Common issues and solutions

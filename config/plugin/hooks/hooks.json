{
  "hooks": {
    "UserPromptSubmit": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "echo 'send this to the orchestra: '",
            "timeout": 1
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "curl -s --retry 5 --retry-delay 1 --retry-connrefused --retry-all-errors -X POST http://localhost:$CCO_DAEMON_PORT/api/knowledge/session-start -H 'Content-Type: application/json' -d '{\"session_id\":\"'\"$CLAUDE_SESSION_ID\"'\",\"project_id\":\"'\"$CLAUDE_PROJECT_DIR\"'\"}'",
            "timeout": 15
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "bash -c 'input=$(cat); cmd=$(echo \"$input\" | jq -r \".tool_input.command // \\\"\\\"\" 2>/dev/null); mode=$(echo \"$input\" | jq -r \".permission_mode // \\\"default\\\"\" 2>/dev/null); result=$(curl -sf -X POST http://127.0.0.1:${CCO_DAEMON_PORT}/api/classify -H \"Content-Type: application/json\" -d \"{\\\"command\\\":\\\"$(echo \"$cmd\" | sed \"s/\\\"/\\\\\\\\\\\"/g\")\\\"}\"); classification=$(echo \"$result\" | jq -r \".classification // \\\"Unknown\\\"\" 2>/dev/null); if [ -z \"$classification\" ] || [ \"$classification\" = \"null\" ]; then classification=\"Unknown\"; fi; if [ \"$mode\" = \"bypassPermissions\" ]; then echo \"{\\\"hookSpecificOutput\\\":{\\\"hookEventName\\\":\\\"PreToolUse\\\",\\\"permissionDecision\\\":\\\"allow\\\",\\\"permissionDecisionReason\\\":\\\"CRUD: $classification (bypass mode)\\\"}}\"; elif [ \"$classification\" = \"Read\" ]; then echo \"{\\\"hookSpecificOutput\\\":{\\\"hookEventName\\\":\\\"PreToolUse\\\",\\\"permissionDecision\\\":\\\"allow\\\",\\\"permissionDecisionReason\\\":\\\"CRUD: READ operation\\\"}}\"; else echo \"{\\\"hookSpecificOutput\\\":{\\\"hookEventName\\\":\\\"PreToolUse\\\",\\\"permissionDecision\\\":\\\"ask\\\",\\\"permissionDecisionReason\\\":\\\"CRUD: $classification operation\\\"}}\"; fi'",
            "timeout": 3,
            "blocking": true
          }
        ]
      }
    ],
    "PreCompact": [
      {
        "matcher": "manual",
        "hooks": [
          {
            "type": "command",
            "command": "curl -s -X POST http://localhost:$CCO_DAEMON_PORT/api/knowledge/pre-compaction -H 'Content-Type: application/json' -d '{\"session_id\":\"'\"$CLAUDE_SESSION_ID\"'\",\"project_id\":\"'\"$CLAUDE_PROJECT_DIR\"'\"}'",
            "timeout": 10
          }
        ]
      },
      {
        "matcher": "auto",
        "hooks": [
          {
            "type": "command",
            "command": "curl -s -X POST http://localhost:$CCO_DAEMON_PORT/api/knowledge/pre-compaction -H 'Content-Type: application/json' -d '{\"session_id\":\"'\"$CLAUDE_SESSION_ID\"'\",\"project_id\":\"'\"$CLAUDE_PROJECT_DIR\"'\"}'",
            "timeout": 10
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "bash -c 'input=$(cat); tool_result=$(echo \"$input\" | jq -r \".tool_result.output // \\\"\\\"\" 2>/dev/null); if echo \"$tool_result\" | grep -qE \"CRUD: (Create|Update|Delete)\"; then echo \"\" >&2; echo \"ðŸ’¡ To reclassify as READ: cco classify --last --expected read\" >&2; fi'",
            "timeout": 1,
            "blocking": false
          }
        ]
      }
    ]
  }
}
